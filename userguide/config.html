

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1.5. Configuration file &mdash; torchmfbd 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="1.6. Mosaicking" href="patches.html" />
    <link rel="prev" title="1.4. Phase diversity" href="diversity.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            torchmfbd
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../userguide.html">1. User guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="installation.html">1.1. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="deconvolution.html">1.2. Spatially invariant deconvolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="deconvolutionSV.html">1.3. Spatially variant deconvolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="diversity.html">1.4. Phase diversity</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">1.5. Configuration file</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#spatially-invariant">1.5.1. Spatially invariant</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#telescope">1.5.1.1. telescope</a></li>
<li class="toctree-l4"><a class="reference internal" href="#images">1.5.1.2. images</a></li>
<li class="toctree-l4"><a class="reference internal" href="#objects">1.5.1.3. objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="#optimization">1.5.1.4. optimization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#regularization">1.5.1.5. regularization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#psf">1.5.1.6. psf</a></li>
<li class="toctree-l4"><a class="reference internal" href="#initialization">1.5.1.7. initialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#annealing">1.5.1.8. annealing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#spatially-variant">1.5.2. Spatially variant</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id3">1.5.2.1. telescope</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">1.5.2.2. images</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">1.5.2.3. objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">1.5.2.4. optimization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">1.5.2.5. regularization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8">1.5.2.6. psf</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9">1.5.2.7. initialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10">1.5.2.8. annealing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patches.html">1.6. Mosaicking</a></li>
<li class="toctree-l2"><a class="reference internal" href="destretch.html">1.7. Destretching</a></li>
<li class="toctree-l2"><a class="reference internal" href="destretch.html#alignment">1.8. Alignment</a></li>
<li class="toctree-l2"><a class="reference internal" href="regularization.html">1.9. Regularization</a></li>
<li class="toctree-l2"><a class="reference internal" href="movie.html">1.10. Movie</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">2. API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../disclaimer.html">3. Disclaimer</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">torchmfbd</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../userguide.html"><span class="section-number">1. </span>User guide</a></li>
      <li class="breadcrumb-item active"><span class="section-number">1.5. </span>Configuration file</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/userguide/config.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="configuration-file">
<span id="configuration"></span><h1><span class="section-number">1.5. </span>Configuration file<a class="headerlink" href="#configuration-file" title="Link to this heading">¶</a></h1>
<p>Configuration files are YAML human-readable files. Note that some of them are optional
and can be absent from the configuration file. If this is the case, a default
value will be used.</p>
<section id="spatially-invariant">
<h2><span class="section-number">1.5.1. </span>Spatially invariant<a class="headerlink" href="#spatially-invariant" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">telescope</span><span class="p">:</span>
    <span class="n">diameter</span><span class="p">:</span> <span class="mf">100.0</span>
    <span class="n">central_obscuration</span> <span class="p">:</span> <span class="mf">0.0</span>
    <span class="n">spider</span> <span class="p">:</span> <span class="mi">0</span>

<span class="n">images</span><span class="p">:</span>
    <span class="n">n_pixel</span> <span class="p">:</span> <span class="mi">64</span>
    <span class="n">pix_size</span> <span class="p">:</span> <span class="mf">0.059</span>
    <span class="n">apodization_border</span> <span class="p">:</span> <span class="mi">6</span>

<span class="n">object1</span><span class="p">:</span>
    <span class="n">wavelength</span> <span class="p">:</span> <span class="mf">8542.0</span>
    <span class="n">image_filter</span><span class="p">:</span> <span class="n">tophat</span>
    <span class="n">cutoff</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.80</span><span class="p">]</span>

<span class="n">object2</span><span class="p">:</span>
    <span class="n">wavelength</span> <span class="p">:</span> <span class="mf">8542.0</span>
    <span class="n">image_filter</span><span class="p">:</span> <span class="n">tophat</span>
    <span class="n">cutoff</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.80</span><span class="p">]</span>

<span class="n">optimization</span><span class="p">:</span>
    <span class="n">gpu</span> <span class="p">:</span> <span class="mi">0</span>
    <span class="n">transform</span> <span class="p">:</span> <span class="n">softplus</span>
    <span class="n">softplus_scale</span> <span class="p">:</span> <span class="mf">1.0</span>
    <span class="n">lr_obj</span> <span class="p">:</span> <span class="mf">0.02</span>
    <span class="n">lr_modes</span> <span class="p">:</span> <span class="mf">0.08</span>
    <span class="n">show_object_info</span><span class="p">:</span> <span class="kc">False</span>

<span class="n">regularization</span><span class="p">:</span>
    <span class="n">iuwt1</span><span class="p">:</span>
        <span class="n">variable</span> <span class="p">:</span> <span class="nb">object</span>
        <span class="k">lambda</span> <span class="p">:</span> <span class="mf">0.0</span>
        <span class="n">nbands</span> <span class="p">:</span> <span class="mi">5</span>

<span class="n">psf</span><span class="p">:</span>
    <span class="n">model</span> <span class="p">:</span> <span class="n">kl</span>
    <span class="n">nmax_modes</span> <span class="p">:</span> <span class="mi">44</span>
    <span class="n">orthogonalize</span> <span class="p">:</span> <span class="kc">False</span>

<span class="n">initialization</span><span class="p">:</span>
    <span class="nb">object</span> <span class="p">:</span> <span class="n">contrast</span>
    <span class="n">modes_std</span> <span class="p">:</span> <span class="mf">0.0</span>

<span class="n">annealing</span><span class="p">:</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">sigmoid</span>
    <span class="n">start_pct</span> <span class="p">:</span> <span class="mf">0.0</span>
    <span class="n">end_pct</span> <span class="p">:</span> <span class="mf">0.85</span>
</pre></div>
</div>
<section id="telescope">
<h3><span class="section-number">1.5.1.1. </span>telescope<a class="headerlink" href="#telescope" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">diameter</span></code>: diameter of the telescope in cm</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">central_obscuration</span></code> : central obscuration of the telescope in cm</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spider</span></code> : width of the spider in cm</p></li>
</ul>
</section>
<section id="images">
<h3><span class="section-number">1.5.1.2. </span>images<a class="headerlink" href="#images" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n_pixel</span></code> : size in pixels of the images to be deconvolved. In case the images are mosaicked to take into account the size of the anisoplanatic patch, this keyword gives the size of the patches</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pix_size</span></code> : pixel size in arcsec</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">apodization_border</span></code> : border of the apodization in pixels to avoid edge effects in the Fourier transform used for the convolution</p></li>
</ul>
</section>
<section id="objects">
<h3><span class="section-number">1.5.1.3. </span>objects<a class="headerlink" href="#objects" title="Link to this heading">¶</a></h3>
<p>Since several objects can be deconvolved simultaneously, one needs to define the parameters for each object. Objects are defined as <code class="docutils literal notranslate"><span class="pre">objectx</span></code>, where <code class="docutils literal notranslate"><span class="pre">x</span></code> is an index
starting from 1.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">wavelength</span></code> : wavelength of the object in angstroms</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">image_filter</span></code> : Fourier filter to be used for the image. Options are <code class="docutils literal notranslate"><span class="pre">tophat</span></code> (a simple tophat filter to avoid frequencies above the cutoff) or <code class="docutils literal notranslate"><span class="pre">scharmer</span></code> (the filter from Lofdahl &amp; Scharmer 1994).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cutoff</span></code> : cutoff frequency. The first element indicates the cutoff frequency below which the filter is 1. The second element marks the frequency above which the filter is 0. In between, a smooth transition is built. All are given in units of the diffraction limit.</p></li>
</ul>
</section>
<section id="optimization">
<h3><span class="section-number">1.5.1.4. </span>optimization<a class="headerlink" href="#optimization" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gpu</span></code> : index of the GPU to be used for the optimization. If you want to use the CPU, just put <code class="docutils literal notranslate"><span class="pre">-1</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">transform</span></code> : in case the object is optimized simultaneously with the wavefronts, a transformation can be applied to ensure its positivity. Options are <code class="docutils literal notranslate"><span class="pre">softplus</span></code> (which uses the softplus function) or <code class="docutils literal notranslate"><span class="pre">none</span></code> (which uses the identity function).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">softplus_scale</span></code> : scale of the softplus function</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lr_obj</span></code> : learning rate for the object</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lr_modes</span></code> : learning rate for the modes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">show_object_info</span></code> : if True, the object information (contrast, minimum and maximum) is shown during the optimization</p></li>
</ul>
</section>
<section id="regularization">
<h3><span class="section-number">1.5.1.5. </span>regularization<a class="headerlink" href="#regularization" title="Link to this heading">¶</a></h3>
<p>Different regularizations can be used simultaneously. Current options are <code class="docutils literal notranslate"><span class="pre">smooth</span></code> (an L2 regularization applied on the spatial derivative of the images) or <code class="docutils literal notranslate"><span class="pre">iuwt</span></code> (an L1 regularization on the isotropic undecimated wavelet transform).</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">iuwt1</span></code><span class="classifier">iuwt regularization to be used. The parameters are:</span></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">variable</span></code> : variable to be regularized. Options are <code class="docutils literal notranslate"><span class="pre">object</span></code> (which regularizes the object) or <code class="docutils literal notranslate"><span class="pre">modes</span></code> (which regularizes the modes)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lambda</span></code> : regularization parameter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nbands</span></code> : number of bands for the iuwt</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">smooth1</span></code><span class="classifier">iuwt regularization to be used. The parameters are:</span></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">variable</span></code> : variable to be regularized. Options are <code class="docutils literal notranslate"><span class="pre">object</span></code> (which regularizes the object) or <code class="docutils literal notranslate"><span class="pre">modes</span></code> (which regularizes the modes)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lambda</span></code> : regularization parameter</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
<section id="psf">
<h3><span class="section-number">1.5.1.6. </span>psf<a class="headerlink" href="#psf" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">model</span></code> : model to be used for the PSF. Options are <code class="docutils literal notranslate"><span class="pre">kl</span></code> (which uses Karhunen-Loeve modes) or <code class="docutils literal notranslate"><span class="pre">zernike</span></code> (which uses Zernike modes)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nmax_modes</span></code> : number of modes to be used for the PSF</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">orthogonalize</span></code> : if True, the modes are re-orthogonalized. This is relevant when strong central obscuration is present.</p></li>
</ul>
</section>
<section id="initialization">
<h3><span class="section-number">1.5.1.7. </span>initialization<a class="headerlink" href="#initialization" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">object</span></code> : initialization of the object. Options are <code class="docutils literal notranslate"><span class="pre">contrast</span></code> (which initializes the object with the contrast) or <code class="docutils literal notranslate"><span class="pre">random</span></code> (which initializes the object with random values). This has impact only if the <a href="#id1"><span class="problematic" id="id2">``</span></a>l2``loss is used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">modes_std</span></code> : standard deviation of the modes at initialization</p></li>
</ul>
</section>
<section id="annealing">
<h3><span class="section-number">1.5.1.8. </span>annealing<a class="headerlink" href="#annealing" title="Link to this heading">¶</a></h3>
<p>The modes are annealed during the optimization. This means modes are added slowly while the optimization proceeds. The specific annealing :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code> : type of annealing. Options are <code class="docutils literal notranslate"><span class="pre">sigmoid</span></code> (which uses a sigmoid function), <code class="docutils literal notranslate"><span class="pre">linear</span></code> (which uses a linear function) or <code class="docutils literal notranslate"><span class="pre">none</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">start_pct</span></code> : percentage of the total number of iterations at which the annealing starts</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">end_pct</span></code> : percentage of the total number of iterations at which the annealing ends</p></li>
</ul>
</section>
</section>
<section id="spatially-variant">
<h2><span class="section-number">1.5.2. </span>Spatially variant<a class="headerlink" href="#spatially-variant" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">telescope</span><span class="p">:</span>
    <span class="n">diameter</span><span class="p">:</span> <span class="mf">100.0</span>
    <span class="n">central_obscuration</span> <span class="p">:</span> <span class="mf">0.0</span>

<span class="n">images</span><span class="p">:</span>
    <span class="n">n_pixel</span> <span class="p">:</span> <span class="mi">256</span>
    <span class="n">wavelength</span> <span class="p">:</span> <span class="mf">8542.0</span>
    <span class="n">pix_size</span> <span class="p">:</span> <span class="mf">0.059</span>
    <span class="n">apodization_border</span> <span class="p">:</span> <span class="mi">6</span>
    <span class="n">remove_gradient_apodization</span> <span class="p">:</span> <span class="kc">False</span>

<span class="n">object1</span><span class="p">:</span>
    <span class="n">wavelength</span> <span class="p">:</span> <span class="mf">8542.0</span>
    <span class="n">image_filter</span><span class="p">:</span> <span class="n">tophat</span>
    <span class="n">cutoff</span> <span class="p">:</span> <span class="mf">0.75</span>

<span class="n">object2</span><span class="p">:</span>
    <span class="n">wavelength</span> <span class="p">:</span> <span class="mf">8542.0</span>
    <span class="n">image_filter</span><span class="p">:</span> <span class="n">tophat</span>
    <span class="n">cutoff</span> <span class="p">:</span> <span class="mf">0.75</span>

<span class="n">optimization</span><span class="p">:</span>
    <span class="n">gpu</span> <span class="p">:</span> <span class="mi">0</span>
    <span class="n">transform</span> <span class="p">:</span> <span class="n">softplus</span>
    <span class="n">softplus_scale</span> <span class="p">:</span> <span class="mf">1000.0</span>
    <span class="n">lr_obj</span> <span class="p">:</span> <span class="mf">0.02</span>
    <span class="n">lr_modes</span> <span class="p">:</span> <span class="mf">0.08</span>
    <span class="n">lr_tt</span> <span class="p">:</span> <span class="mf">0.003</span>

<span class="n">regularization</span><span class="p">:</span>
    <span class="n">smooth1</span><span class="p">:</span>
        <span class="n">variable</span><span class="p">:</span> <span class="n">tiptilt</span>
        <span class="k">lambda</span><span class="p">:</span> <span class="mf">0.01</span>
    <span class="n">smooth2</span><span class="p">:</span>
        <span class="n">variable</span><span class="p">:</span> <span class="n">modes</span>
        <span class="k">lambda</span><span class="p">:</span> <span class="mf">0.01</span>
    <span class="n">iuwt1</span><span class="p">:</span>
        <span class="n">variable</span> <span class="p">:</span> <span class="nb">object</span>
        <span class="k">lambda</span> <span class="p">:</span> <span class="mf">0.00</span>
        <span class="n">nbands</span> <span class="p">:</span> <span class="mi">5</span>

<span class="n">psf</span><span class="p">:</span>
    <span class="n">model</span> <span class="p">:</span> <span class="n">nmf</span>
    <span class="n">nmax_modes</span> <span class="p">:</span> <span class="mi">150</span>
    <span class="n">filename</span><span class="p">:</span> <span class="s1">&#39;../basis/nmf_8542_n_150_r0_5_30.npz&#39;</span>
    <span class="n">ngrid_modes</span><span class="p">:</span> <span class="mi">8</span>

<span class="n">initialization</span><span class="p">:</span>
    <span class="nb">object</span> <span class="p">:</span> <span class="n">contrast</span>
    <span class="n">modes_std</span> <span class="p">:</span> <span class="mf">0.0</span>

<span class="n">annealing</span><span class="p">:</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">none</span>
    <span class="n">start_pct</span> <span class="p">:</span> <span class="mf">0.0</span>
    <span class="n">end_pct</span> <span class="p">:</span> <span class="mf">0.85</span>
</pre></div>
</div>
<section id="id3">
<h3><span class="section-number">1.5.2.1. </span>telescope<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">diameter</span></code>: diameter of the telescope in cm</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">central_obscuration</span></code> : central obscuration of the telescope in cm</p></li>
</ul>
</section>
<section id="id4">
<h3><span class="section-number">1.5.2.2. </span>images<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n_pixel</span></code> : size in pixels of the images to be deconvolved. In case the images are mosaicked to take into account the size of the anisoplanatic patch, this keyword gives the size of the patches</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pix_size</span></code> : pixel size in arcsec</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">apodization_border</span></code> : border of the apodization in pixels to avoid edge effects in the Fourier transform used for the convolution</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">remove_gradient_apodization</span></code> : if True, the gradient of the image is removed before the apodization. This is useful to remove artifacts when the images have strong gradients</p></li>
</ul>
</section>
<section id="id5">
<h3><span class="section-number">1.5.2.3. </span>objects<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<p>Since several objects can be deconvolved simultaneously, one needs to define the parameters for each object. Objects are defined as <code class="docutils literal notranslate"><span class="pre">objectx</span></code>, where <code class="docutils literal notranslate"><span class="pre">x</span></code> is an index
starting from 1.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">wavelength</span></code> : wavelength of the object in angstroms</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">image_filter</span></code> : Fourier filter to be used for the image. Options are <code class="docutils literal notranslate"><span class="pre">tophat</span></code> (a simple tophat filter to avoid frequencies above the cutoff) or <code class="docutils literal notranslate"><span class="pre">scharmer</span></code> (the filter from Lofdahl &amp; Scharmer 1994).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cutoff</span></code> : cutoff frequency indicated in units of the diffraction limit</p></li>
</ul>
</section>
<section id="id6">
<h3><span class="section-number">1.5.2.4. </span>optimization<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gpu</span></code> : index of the GPU to be used for the optimization. If you want to use the CPU, just put <code class="docutils literal notranslate"><span class="pre">-1</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">transform</span></code> : in case the object is optimized simultaneously with the wavefronts, a transformation can be applied to ensure its positivity. Options are <code class="docutils literal notranslate"><span class="pre">softplus</span></code> (which uses the softplus function) or <code class="docutils literal notranslate"><span class="pre">none</span></code> (which uses the identity function).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">softplus_scale</span></code> : scale of the softplus function</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lr_obj</span></code> : learning rate for the object</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lr_tt</span></code> : learning rate for the tip-tilt</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lr_modes</span></code> : learning rate for the modes</p></li>
</ul>
</section>
<section id="id7">
<h3><span class="section-number">1.5.2.5. </span>regularization<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<p>Different regularizations can be used simultaneously. Current options are <code class="docutils literal notranslate"><span class="pre">smooth</span></code> (an L2 regularization applied on the spatial derivative of the images) or <code class="docutils literal notranslate"><span class="pre">iuwt</span></code> (an L1 regularization on the isotropic undecimated wavelet transform).</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">iuwt1</span></code><span class="classifier">iuwt regularization to be used. The parameters are:</span></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">variable</span></code> : variable to be regularized. Options are <code class="docutils literal notranslate"><span class="pre">object</span></code> (which regularizes the object) or <code class="docutils literal notranslate"><span class="pre">modes</span></code> (which regularizes the modes)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lambda</span></code> : regularization parameter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nbands</span></code> : number of bands for the iuwt</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">smooth1</span></code><span class="classifier">iuwt regularization to be used. The parameters are:</span></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">variable</span></code> : variable to be regularized. Options are <code class="docutils literal notranslate"><span class="pre">object</span></code> (which regularizes the object) or <code class="docutils literal notranslate"><span class="pre">modes</span></code> (which regularizes the modes)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lambda</span></code> : regularization parameter</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
<section id="id8">
<h3><span class="section-number">1.5.2.6. </span>psf<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">model</span></code> : model to be used for the PSF. Options are <code class="docutils literal notranslate"><span class="pre">nmf</span></code> (which uses non-negative matrix factorization) or <code class="docutils literal notranslate"><span class="pre">pca</span></code> (which uses principal component analysis)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nmax_modes</span></code> : number of modes to be used for the PSF</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">filename</span></code> : filename of the basis to be used for the PSF</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ngrid_modes</span></code> : number of grid points where to infer the PSF modes. They will be interpolated to the full size of the image</p></li>
</ul>
</section>
<section id="id9">
<h3><span class="section-number">1.5.2.7. </span>initialization<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">object</span></code> : initialization of the object. Options are <code class="docutils literal notranslate"><span class="pre">contrast</span></code> (which initializes the object with the contrast) or <code class="docutils literal notranslate"><span class="pre">random</span></code> (which initializes the object with random values). This has impact only if the object is inferred.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">modes_std</span></code> : standard deviation of the modes at initialization</p></li>
</ul>
</section>
<section id="id10">
<h3><span class="section-number">1.5.2.8. </span>annealing<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h3>
<p>The modes are annealed during the optimization. This means modes are added slowly while the optimization proceeds. The specific annealing :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code> : type of annealing. Options are <code class="docutils literal notranslate"><span class="pre">sigmoid</span></code> (which uses a sigmoid function), <code class="docutils literal notranslate"><span class="pre">linear</span></code> (which uses a linear function) or <code class="docutils literal notranslate"><span class="pre">none</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">start_pct</span></code> : percentage of the total number of iterations at which the annealing starts</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">end_pct</span></code> : percentage of the total number of iterations at which the annealing ends</p></li>
</ul>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="diversity.html" class="btn btn-neutral float-left" title="1.4. Phase diversity" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="patches.html" class="btn btn-neutral float-right" title="1.6. Mosaicking" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Andres Asensio Ramos.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>